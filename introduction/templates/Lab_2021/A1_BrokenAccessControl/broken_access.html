{% extends 'introduction/base.html' %}
{% block content %}
{% block title %}
<title>Broken Access Control</title>
{% endblock %}

<div class="" style="max-width: 900px; margin: 0 auto; padding: 2rem;">
    <h2 style="margin-bottom: 1rem;">Broken Access Control</h2>

    <section style="margin-bottom: 2rem;">
        <h4>What is Broken Access Control?</h4>
        <p>
            Access control determines what content and actions a user is allowed after authentication.
            Improper implementation can lead to unauthorized access or actions.
        </p>
        <ul>
            <li>Violation of least privilege or deny-by-default principles</li>
            <li>Modifying URLs, parameters, or requests to bypass controls</li>
            <li>Editing or viewing other users' data (IDOR)</li>
            <li>Missing access control in APIs (POST, PUT, DELETE)</li>
            <li>Privilege escalation (e.g., regular user acting as admin)</li>
            <li>CORS misconfiguration</li>
            <li>Accessing restricted pages via direct links</li>
        </ul>
    </section>

    <section style="margin-bottom: 2rem;">
        <details>
            <summary style="cursor: pointer; font-weight: bold;">Lab 1: Cookie-Based Access Control</summary>
            <div style="margin-top: 1rem;">
                <p>
                    Login with: <code>jack:jacktheripper</code><br>
                    Use BurpSuite to change the <code>admin</code> cookie from <code>0</code> to <code>1</code> after login.<br>
                    This gives admin access and reveals the secret key.
                </p>
                <button onclick="window.location.href='/broken_access_lab_1'" style="margin-top: 0.5rem;">Access Lab 1</button>
            </div>
        </details>
    </section>

    <section style="margin-bottom: 2rem;">
        <details>
            <summary style="cursor: pointer; font-weight: bold;">Lab 2: Header Manipulation</summary>
            <div style="margin-top: 1rem;">
                <p>
                    Login with: <code>jack:jacktheripper</code><br>
                    Find a clue in the source code requiring <code>User-Agent: pygoat_admin</code>.<br>
                    Change it using BurpSuite to gain admin access.
                </p>
                <button onclick="window.location.href='/broken_access_lab_2'" style="margin-top: 0.5rem;">Access Lab 2</button>
            </div>
        </details>
    </section>

    <section style="margin-bottom: 2rem;">
        <details>
            <summary style="cursor: pointer; font-weight: bold;">Lab 3: Privilege Escalation</summary>
            <div style="margin-top: 1rem;">
                <p>
                    Admin: <code>admin:admin_pass</code><br>
                    User: <code>john:reaper</code><br><br>
                    Try accessing admin pages with regular user credentials or without logging in.
                </p>
                <button onclick="window.location.href='/broken_access_lab_3'" style="margin-top: 0.5rem;">Access Lab 3</button>
            </div>
        </details>
    </section>

    <section style="margin-bottom: 2rem;">
        <h4>Mitigation Strategies</h4>
        <ul>
            <li>Deny access by default except for public resources</li>
            <li>Centralize access control and re-use throughout the app</li>
            <li>Enforce ownership checks at the model level</li>
            <li>Limit and monitor CORS usage</li>
            <li>Remove sensitive files from production servers</li>
            <li>Log and alert on access control failures</li>
            <li>Rate-limit endpoints to prevent abuse</li>
            <li>Use short-lived sessions or revocable tokens</li>
        </ul>
    </section>
</div>

{% endblock %}
