{% extends 'introduction/base.html' %}

{% block title %}
  <title>Cryptographic Failure</title>
{% endblock %}

{% block content %}
<div class="my-5">
  <h2 class="mb-4 text-primary">Cryptographic Failure</h2>

  <div class="card mb-4 shadow-sm">
    <div class="card-body">
      <h4 class="card-title">What is Cryptographic Failure?</h4>
      <p class="card-text">
        Cryptographic failure is the root cause of sensitive data exposure. Common issues include:
        <strong>CWE-259</strong> (Use of Hard-coded Password), <strong>CWE-327</strong> (Broken or Risky Crypto Algorithm),
        and <strong>CWE-331</strong> (Insufficient Entropy).<br><br>

        It's essential to determine the protection needs of data both in transit and at restâ€”especially for sensitive data such as passwords, credit card numbers, health records, and personal information. These may fall under legal requirements like GDPR or PCI DSS.
      </p>
    </div>
  </div>

  <div class="accordion mb-4" id="labsAccordion">
    <!-- Lab 1 -->
    <div class="accordion-item">
      <h2 class="accordion-header" id="lab1Header">
        <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#lab1" aria-expanded="true" aria-controls="lab1">
          Lab 1 Details
        </button>
      </h2>
      <div id="lab1" class="accordion-collapse collapse show" aria-labelledby="lab1Header" data-bs-parent="#labsAccordion">
        <div class="accordion-body">
          <p>Can you login as Admin? A hacker previously performed a SQL injection attack and retrieved this user table dump:</p>
          <pre><code>alex,9d6edee6ce9312981084bd98eb3751ee
admin,c93ccd78b2076528346216b3b2f701e6
rupak,5ee3547adb4481902349bdd0f2ffba93</code></pre>
          <div class="text-end">
            <a href="/cryptographic_failure/lab" class="btn btn-outline-primary">Access Lab</a>
          </div>
        </div>
      </div>
    </div>

    <!-- Lab 2 -->
    <div class="accordion-item">
      <h2 class="accordion-header" id="lab2Header">
        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#lab2" aria-expanded="false" aria-controls="lab2">
          Lab 2 Details
        </button>
      </h2>
      <div id="lab2" class="accordion-collapse collapse" aria-labelledby="lab2Header" data-bs-parent="#labsAccordion">
        <div class="accordion-body">
          <p>Can you login as Admin? This time, the hacker used a stronger hashing algorithm.</p>
          <pre><code>alex,2a280ba4ff0f8c763c5b0606f40effc3319dbc4c91d4361a39990292d4b7b0cd
admin,d953b4a47ce307fcb8b1b85fc6a0d34aea5585b6ad9188beb94c1eea9bbb5c7a
rupak,c17cde8d179a37cad4bd93e55355fdf240eb52d585e428c1cdfecc68123e192a</code></pre>
          <div class="text-end">
            <a href="/cryptographic_failure/lab2" class="btn btn-outline-primary">Access Lab</a>
          </div>
        </div>
      </div>
    </div>

    <!-- Lab 3 -->
    <div class="accordion-item">
      <h2 class="accordion-header" id="lab3Header">
        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#lab3" aria-expanded="false" aria-controls="lab3">
          Lab 3 Details
        </button>
      </h2>
      <div id="lab3" class="accordion-collapse collapse" aria-labelledby="lab3Header" data-bs-parent="#labsAccordion">
        <div class="accordion-body">
          <p>We have a user credential. Can you login as admin and retrieve the secret?</p>
          <pre><code>Username: User
Password: P@$$w0rd</code></pre>
          <div class="text-end">
            <a href="/cryptographic_failure/lab3" class="btn btn-outline-primary">Access Lab</a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Mitigation Section -->
  <div class="card shadow-sm">
    <div class="card-body">
      <h4 class="card-title mb-3">Mitigation</h4>
      <ul class="list-group list-group-flush">
        <li class="list-group-item">Classify data processed, stored, or transmitted. Identify sensitive data.</li>
        <li class="list-group-item">Don't store sensitive data unnecessarily. Use tokenization or truncation when possible.</li>
        <li class="list-group-item">Encrypt all sensitive data at rest.</li>
        <li class="list-group-item">Use strong, standard algorithms and secure key management.</li>
        <li class="list-group-item">Encrypt data in transit using secure protocols like TLS. Enforce HSTS.</li>
        <li class="list-group-item">Disable caching for sensitive responses.</li>
        <li class="list-group-item">Store passwords with adaptive, salted hashing functions (e.g., Argon2, bcrypt).</li>
        <li class="list-group-item">Avoid deprecated protocols and cryptographic functions.</li>
        <li class="list-group-item">Use authenticated encryption and secure random number generation.</li>
      </ul>
    </div>
  </div>

  <div class="text-center mt-4">
    <a href="/" class="btn btn-secondary">Code Discussion</a>
  </div>
</div>
{% endblock %}
